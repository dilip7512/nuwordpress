Enumerable=function(){var t=function(t){this.GetEnumerator=t};t.Choice=function(){var e=arguments[0]instanceof Array?arguments[0]:arguments;return new t(function(){return new a(n.Blank,function(){return this.Yield(e[Math.floor(Math.random()*e.length)])},n.Blank)})},t.Cycle=function(){var e=arguments[0]instanceof Array?arguments[0]:arguments;return new t(function(){var t=0;return new a(n.Blank,function(){return t>=e.length&&(t=0),this.Yield(e[t++])},n.Blank)})},t.Empty=function(){return new t(function(){return new a(n.Blank,function(){return!1},n.Blank)})},t.From=function(i){if(null==i)return t.Empty();if(i instanceof t)return i;if(typeof i==e.Number||typeof i==e.Boolean)return t.Repeat(i,1);if(typeof i==e.String)return new t(function(){var t=0;return new a(n.Blank,function(){return t<i.length&&this.Yield(i.charAt(t++))},n.Blank)});if(typeof i!=e.Function){if(typeof i.length==e.Number)return new l(i);if(!(i instanceof Object)&&r.IsIEnumerable(i))return new t(function(){var t,e=!0;return new a(function(){t=new Enumerator(i)},function(){return e?e=!1:t.moveNext(),!t.atEnd()&&this.Yield(t.item())},n.Blank)})}return new t(function(){var t=[],e=0;return new a(function(){for(var n in i)i[n]instanceof Function||t.push({Key:n,Value:i[n]})},function(){return e<t.length&&this.Yield(t[e++])},n.Blank)})},t.Return=function(n){return t.Repeat(n,1)},t.Matches=function(e,r,i){return null==i&&(i=""),r instanceof RegExp&&(i+=r.ignoreCase?"i":"",i+=r.multiline?"m":"",r=r.source),-1===i.indexOf("g")&&(i+="g"),new t(function(){var t;return new a(function(){t=new RegExp(r,i)},function(){var n=t.exec(e);return!!n&&this.Yield(n)},n.Blank)})},t.Range=function(n,e,r){return null==r&&(r=1),t.ToInfinity(n,r).Take(e)},t.RangeDown=function(n,e,r){return null==r&&(r=1),t.ToNegativeInfinity(n,r).Take(e)},t.RangeTo=function(n,e,r){return null==r&&(r=1),n<e?t.ToInfinity(n,r).TakeWhile(function(t){return t<=e}):t.ToNegativeInfinity(n,r).TakeWhile(function(t){return t>=e})},t.Repeat=function(e,r){return null!=r?t.Repeat(e).Take(r):new t(function(){return new a(n.Blank,function(){return this.Yield(e)},n.Blank)})},t.RepeatWithFinalize=function(n,e){return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var t;return new a(function(){t=n()},function(){return this.Yield(t)},function(){null!=t&&(e(t),t=null)})})},t.Generate=function(e,i){return null!=i?t.Generate(e).Take(i):(e=r.CreateLambda(e),new t(function(){return new a(n.Blank,function(){return this.Yield(e())},n.Blank)}))},t.ToInfinity=function(e,r){return null==e&&(e=0),null==r&&(r=1),new t(function(){var t;return new a(function(){t=e-r},function(){return this.Yield(t+=r)},n.Blank)})},t.ToNegativeInfinity=function(e,r){return null==e&&(e=0),null==r&&(r=1),new t(function(){var t;return new a(function(){t=e+r},function(){return this.Yield(t-=r)},n.Blank)})},t.Unfold=function(e,i){return i=r.CreateLambda(i),new t(function(){var t,r=!0;return new a(n.Blank,function(){return r?(r=!1,t=e,this.Yield(t)):(t=i(t),this.Yield(t))},n.Blank)})},t.prototype={CascadeBreadthFirst:function(n,e){var i=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var u,o=0,c=[];return new a(function(){u=i.GetEnumerator()},function(){for(;;){if(u.MoveNext())return c.push(u.Current()),this.Yield(e(u.Current(),o));var i=t.From(c).SelectMany(function(t){return n(t)});if(!i.Any())return!1;o++,c=[],r.Dispose(u),u=i.GetEnumerator()}},function(){r.Dispose(u)})})},CascadeDepthFirst:function(n,e){var i=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),new t(function(){var u,o=[];return new a(function(){u=i.GetEnumerator()},function(){for(;;){if(u.MoveNext()){var i=e(u.Current(),o.length);return o.push(u),u=t.From(n(u.Current())).GetEnumerator(),this.Yield(i)}if(o.length<=0)return!1;r.Dispose(u),u=o.pop()}},function(){try{r.Dispose(u)}finally{t.From(o).ForEach(function(t){t.Dispose()})}})})},Flatten:function(){var e=this;return new t(function(){var i,u=null;return new a(function(){i=e.GetEnumerator()},function(){for(;;){if(null!=u){if(u.MoveNext())return this.Yield(u.Current());u=null}if(i.MoveNext()){if(i.Current()instanceof Array){r.Dispose(u),u=t.From(i.Current()).SelectMany(n.Identity).Flatten().GetEnumerator();continue}return this.Yield(i.Current())}return!1}},function(){try{r.Dispose(i)}finally{r.Dispose(u)}})})},Pairwise:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t;return new a(function(){(t=e.GetEnumerator()).MoveNext()},function(){var e=t.Current();return!!t.MoveNext()&&this.Yield(n(e,t.Current()))},function(){r.Dispose(t)})})},Scan:function(n,e,i){if(null!=i)return this.Scan(n,e).Select(i);var u;null==e?(e=r.CreateLambda(n),u=!1):(e=r.CreateLambda(e),u=!0);var o=this;return new t(function(){var t,i,c=!0;return new a(function(){t=o.GetEnumerator()},function(){if(c){if(c=!1,u)return this.Yield(i=n);if(t.MoveNext())return this.Yield(i=t.Current())}return!!t.MoveNext()&&this.Yield(i=e(i,t.Current()))},function(){r.Dispose(t)})})},Select:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t,i=0;return new a(function(){t=e.GetEnumerator()},function(){return!!t.MoveNext()&&this.Yield(n(t.Current(),i++))},function(){r.Dispose(t)})})},SelectMany:function(n,e){var i=this;return n=r.CreateLambda(n),null==e&&(e=function(t,n){return n}),e=r.CreateLambda(e),new t(function(){var u,o=void 0,c=0;return new a(function(){u=i.GetEnumerator()},function(){if(void 0===o&&!u.MoveNext())return!1;do{if(null==o){var i=n(u.Current(),c++);o=t.From(i).GetEnumerator()}if(o.MoveNext())return this.Yield(e(u.Current(),o.Current()));r.Dispose(o),o=null}while(u.MoveNext());return!1},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},Where:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,i=0;return new a(function(){t=e.GetEnumerator()},function(){for(;t.MoveNext();)if(n(t.Current(),i++))return this.Yield(t.Current());return!1},function(){r.Dispose(t)})})},OfType:function(t){var n;switch(t){case Number:n=e.Number;break;case String:n=e.String;break;case Boolean:n=e.Boolean;break;case Function:n=e.Function;break;default:n=null}return null===n?this.Where(function(n){return n instanceof t}):this.Where(function(t){return typeof t===n})},Zip:function(n,e){e=r.CreateLambda(e);var i=this;return new t(function(){var u,o,c=0;return new a(function(){u=i.GetEnumerator(),o=t.From(n).GetEnumerator()},function(){return!(!u.MoveNext()||!o.MoveNext())&&this.Yield(e(u.Current(),o.Current(),c++))},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},Join:function(e,i,u,o,c){i=r.CreateLambda(i),u=r.CreateLambda(u),o=r.CreateLambda(o),c=r.CreateLambda(c);var s=this;return new t(function(){var f,l,h=null,v=0;return new a(function(){f=s.GetEnumerator(),l=t.From(e).ToLookup(u,n.Identity,c)},function(){for(;;){if(null!=h){var t=h[v++];if(void 0!==t)return this.Yield(o(f.Current(),t));t=null,v=0}if(!f.MoveNext())return!1;var n=i(f.Current());h=l.Get(n).ToArray()}},function(){r.Dispose(f)})})},GroupJoin:function(e,i,u,o,c){i=r.CreateLambda(i),u=r.CreateLambda(u),o=r.CreateLambda(o),c=r.CreateLambda(c);var s=this;return new t(function(){var f=s.GetEnumerator(),l=null;return new a(function(){f=s.GetEnumerator(),l=t.From(e).ToLookup(u,n.Identity,c)},function(){if(f.MoveNext()){var t=l.Get(i(f.Current()));return this.Yield(o(f.Current(),t))}return!1},function(){r.Dispose(f)})})},All:function(t){t=r.CreateLambda(t);var n=!0;return this.ForEach(function(e){if(!t(e))return n=!1,!1}),n},Any:function(t){t=r.CreateLambda(t);var n=this.GetEnumerator();try{if(0==arguments.length)return n.MoveNext();for(;n.MoveNext();)if(t(n.Current()))return!0;return!1}finally{r.Dispose(n)}},Concat:function(n){var e=this;return new t(function(){var i,u;return new a(function(){i=e.GetEnumerator()},function(){if(null==u){if(i.MoveNext())return this.Yield(i.Current());u=t.From(n).GetEnumerator()}return!!u.MoveNext()&&this.Yield(u.Current())},function(){try{r.Dispose(i)}finally{r.Dispose(u)}})})},Insert:function(n,e){var i=this;return new t(function(){var u,o,c=0,s=!1;return new a(function(){u=i.GetEnumerator(),o=t.From(e).GetEnumerator()},function(){return c==n&&o.MoveNext()?(s=!0,this.Yield(o.Current())):u.MoveNext()?(c++,this.Yield(u.Current())):!(s||!o.MoveNext())&&this.Yield(o.Current())},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},Alternate:function(n){return n=t.Return(n),this.SelectMany(function(e){return t.Return(e).Concat(n)}).TakeExceptLast()},Contains:function(t,n){n=r.CreateLambda(n);var e=this.GetEnumerator();try{for(;e.MoveNext();)if(n(e.Current())===t)return!0;return!1}finally{r.Dispose(e)}},DefaultIfEmpty:function(n){var e=this;return new t(function(){var t,i=!0;return new a(function(){t=e.GetEnumerator()},function(){return t.MoveNext()?(i=!1,this.Yield(t.Current())):!!i&&(i=!1,this.Yield(n))},function(){r.Dispose(t)})})},Distinct:function(n){return this.Except(t.Empty(),n)},Except:function(n,e){e=r.CreateLambda(e);var i=this;return new t(function(){var u,o;return new a(function(){u=i.GetEnumerator(),o=new h(e),t.From(n).ForEach(function(t){o.Add(t)})},function(){for(;u.MoveNext();){var t=u.Current();if(!o.Contains(t))return o.Add(t),this.Yield(t)}return!1},function(){r.Dispose(u)})})},Intersect:function(n,e){e=r.CreateLambda(e);var i=this;return new t(function(){var u,o,c;return new a(function(){u=i.GetEnumerator(),o=new h(e),t.From(n).ForEach(function(t){o.Add(t)}),c=new h(e)},function(){for(;u.MoveNext();){var t=u.Current();if(!c.Contains(t)&&o.Contains(t))return c.Add(t),this.Yield(t)}return!1},function(){r.Dispose(u)})})},SequenceEqual:function(n,e){e=r.CreateLambda(e);var i=this.GetEnumerator();try{var u=t.From(n).GetEnumerator();try{for(;i.MoveNext();)if(!u.MoveNext()||e(i.Current())!==e(u.Current()))return!1;return!u.MoveNext()}finally{r.Dispose(u)}}finally{r.Dispose(i)}},Union:function(n,e){e=r.CreateLambda(e);var i=this;return new t(function(){var u,o,c;return new a(function(){u=i.GetEnumerator(),c=new h(e)},function(){var e;if(void 0===o){for(;u.MoveNext();)if(e=u.Current(),!c.Contains(e))return c.Add(e),this.Yield(e);o=t.From(n).GetEnumerator()}for(;o.MoveNext();)if(e=o.Current(),!c.Contains(e))return c.Add(e),this.Yield(e);return!1},function(){try{r.Dispose(u)}finally{r.Dispose(o)}})})},OrderBy:function(t){return new s(this,t,!1)},OrderByDescending:function(t){return new s(this,t,!0)},Reverse:function(){var e=this;return new t(function(){var t,r;return new a(function(){t=e.ToArray(),r=t.length},function(){return r>0&&this.Yield(t[--r])},n.Blank)})},Shuffle:function(){var e=this;return new t(function(){var t;return new a(function(){t=e.ToArray()},function(){if(t.length>0){var n=Math.floor(Math.random()*t.length);return this.Yield(t.splice(n,1)[0])}return!1},n.Blank)})},GroupBy:function(n,e,i,u){var o=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),null!=i&&(i=r.CreateLambda(i)),u=r.CreateLambda(u),new t(function(){var t;return new a(function(){t=o.ToLookup(n,e,u).ToEnumerable().GetEnumerator()},function(){for(;t.MoveNext();)return null==i?this.Yield(t.Current()):this.Yield(i(t.Current().Key(),t.Current()));return!1},function(){r.Dispose(t)})})},PartitionBy:function(n,e,i,u){var o,c=this;return n=r.CreateLambda(n),e=r.CreateLambda(e),u=r.CreateLambda(u),null==i?(o=!1,i=function(t,n){return new p(t,n)}):(o=!0,i=r.CreateLambda(i)),new t(function(){var s,f,l,h=[];return new a(function(){(s=c.GetEnumerator()).MoveNext()&&(f=n(s.Current()),l=u(f),h.push(e(s.Current())))},function(){for(var r;1==(r=s.MoveNext())&&l===u(n(s.Current()));)h.push(e(s.Current()));if(h.length>0){var a=i(f,o?t.From(h):h);return r?(f=n(s.Current()),l=u(f),h=[e(s.Current())]):h=[],this.Yield(a)}return!1},function(){r.Dispose(s)})})},BufferWithCount:function(n){var e=this;return new t(function(){var t;return new a(function(){t=e.GetEnumerator()},function(){for(var e=[],r=0;t.MoveNext();)if(e.push(t.Current()),++r>=n)return this.Yield(e);return e.length>0&&this.Yield(e)},function(){r.Dispose(t)})})},Aggregate:function(t,n,e){return this.Scan(t,n,e).Last()},Average:function(t){t=r.CreateLambda(t);var n=0,e=0;return this.ForEach(function(r){n+=t(r),++e}),n/e},Count:function(t){t=null==t?n.True:r.CreateLambda(t);var e=0;return this.ForEach(function(n,r){t(n,r)&&++e}),e},Max:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(function(t,n){return t>n?t:n})},Min:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(function(t,n){return t<n?t:n})},MaxBy:function(t){return t=r.CreateLambda(t),this.Aggregate(function(n,e){return t(n)>t(e)?n:e})},MinBy:function(t){return t=r.CreateLambda(t),this.Aggregate(function(n,e){return t(n)<t(e)?n:e})},Sum:function(t){return null==t&&(t=n.Identity),this.Select(t).Aggregate(0,function(t,n){return t+n})},ElementAt:function(t){var n,e=!1;if(this.ForEach(function(r,i){if(i==t)return n=r,e=!0,!1}),!e)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return n},ElementAtOrDefault:function(t,n){var e,r=!1;return this.ForEach(function(n,i){if(i==t)return e=n,r=!0,!1}),r?e:n},First:function(t){if(null!=t)return this.Where(t).First();var n,e=!1;if(this.ForEach(function(t){return n=t,e=!0,!1}),!e)throw new Error("First:No element satisfies the condition.");return n},FirstOrDefault:function(t,n){if(null!=n)return this.Where(n).FirstOrDefault(t);var e,r=!1;return this.ForEach(function(t){return e=t,r=!0,!1}),r?e:t},Last:function(t){if(null!=t)return this.Where(t).Last();var n,e=!1;if(this.ForEach(function(t){e=!0,n=t}),!e)throw new Error("Last:No element satisfies the condition.");return n},LastOrDefault:function(t,n){if(null!=n)return this.Where(n).LastOrDefault(t);var e,r=!1;return this.ForEach(function(t){r=!0,e=t}),r?e:t},Single:function(t){if(null!=t)return this.Where(t).Single();var n,e=!1;if(this.ForEach(function(t){if(e)throw new Error("Single:sequence contains more than one element.");e=!0,n=t}),!e)throw new Error("Single:No element satisfies the condition.");return n},SingleOrDefault:function(t,n){if(null!=n)return this.Where(n).SingleOrDefault(t);var e,r=!1;return this.ForEach(function(t){if(r)throw new Error("Single:sequence contains more than one element.");r=!0,e=t}),r?e:t},Skip:function(n){var e=this;return new t(function(){var t,i=0;return new a(function(){for(t=e.GetEnumerator();i++<n&&t.MoveNext(););},function(){return!!t.MoveNext()&&this.Yield(t.Current())},function(){r.Dispose(t)})})},SkipWhile:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,i=0,u=!1;return new a(function(){t=e.GetEnumerator()},function(){for(;!u;){if(!t.MoveNext())return!1;if(!n(t.Current(),i++))return u=!0,this.Yield(t.Current())}return!!t.MoveNext()&&this.Yield(t.Current())},function(){r.Dispose(t)})})},Take:function(n){var e=this;return new t(function(){var t,i=0;return new a(function(){t=e.GetEnumerator()},function(){return!!(i++<n&&t.MoveNext())&&this.Yield(t.Current())},function(){r.Dispose(t)})})},TakeWhile:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t,i=0;return new a(function(){t=e.GetEnumerator()},function(){return!(!t.MoveNext()||!n(t.Current(),i++))&&this.Yield(t.Current())},function(){r.Dispose(t)})})},TakeExceptLast:function(n){null==n&&(n=1);var e=this;return new t(function(){if(n<=0)return e.GetEnumerator();var t,i=[];return new a(function(){t=e.GetEnumerator()},function(){for(;t.MoveNext();){if(i.length==n)return i.push(t.Current()),this.Yield(i.shift());i.push(t.Current())}return!1},function(){r.Dispose(t)})})},TakeFromLast:function(n){if(n<=0||null==n)return t.Empty();var e=this;return new t(function(){var i,u,o=[];return new a(function(){i=e.GetEnumerator()},function(){for(;i.MoveNext();)o.length==n&&o.shift(),o.push(i.Current());return null==u&&(u=t.From(o).GetEnumerator()),!!u.MoveNext()&&this.Yield(u.Current())},function(){r.Dispose(u)})})},IndexOf:function(t){var n=null;return this.ForEach(function(e,r){if(e===t)return n=r,!0}),null!==n?n:-1},LastIndexOf:function(t){var n=-1;return this.ForEach(function(e,r){e===t&&(n=r)}),n},ToArray:function(){var t=[];return this.ForEach(function(n){t.push(n)}),t},ToLookup:function(t,n,e){t=r.CreateLambda(t),n=r.CreateLambda(n),e=r.CreateLambda(e);var i=new h(e);return this.ForEach(function(e){var r=t(e),u=n(e),o=i.Get(r);void 0!==o?o.push(u):i.Add(r,[u])}),new v(i)},ToObject:function(t,n){t=r.CreateLambda(t),n=r.CreateLambda(n);var e={};return this.ForEach(function(r){e[t(r)]=n(r)}),e},ToDictionary:function(t,n,e){t=r.CreateLambda(t),n=r.CreateLambda(n),e=r.CreateLambda(e);var i=new h(e);return this.ForEach(function(e){i.Add(t(e),n(e))}),i},ToJSON:function(t,n){return JSON.stringify(this.ToArray(),t,n)},ToString:function(t,e){return null==t&&(t=""),null==e&&(e=n.Identity),this.Select(e).ToArray().join(t)},Do:function(n){var e=this;return n=r.CreateLambda(n),new t(function(){var t,i=0;return new a(function(){t=e.GetEnumerator()},function(){return!!t.MoveNext()&&(n(t.Current(),i++),this.Yield(t.Current()))},function(){r.Dispose(t)})})},ForEach:function(t){t=r.CreateLambda(t);var n=0,e=this.GetEnumerator();try{for(;e.MoveNext()&&!1!==t(e.Current(),n++););}finally{r.Dispose(e)}},Write:function(t,n){null==t&&(t=""),n=r.CreateLambda(n);var e=!0;this.ForEach(function(r){e?e=!1:document.write(t),document.write(n(r))})},WriteLine:function(t){t=r.CreateLambda(t),this.ForEach(function(n){document.write(t(n)),document.write("<br />")})},Force:function(){var t=this.GetEnumerator();try{for(;t.MoveNext(););}finally{r.Dispose(t)}},Let:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var i;return new a(function(){i=t.From(n(e)).GetEnumerator()},function(){return!!i.MoveNext()&&this.Yield(i.Current())},function(){r.Dispose(i)})})},Share:function(){var e,r=this;return new t(function(){return new a(function(){null==e&&(e=r.GetEnumerator())},function(){return!!e.MoveNext()&&this.Yield(e.Current())},n.Blank)})},MemoizeAll:function(){var e,r,i=this;return new t(function(){var t=-1;return new a(function(){null==r&&(r=i.GetEnumerator(),e=[])},function(){return t++,e.length<=t?!!r.MoveNext()&&this.Yield(e[t]=r.Current()):this.Yield(e[t])},n.Blank)})},Catch:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t;return new a(function(){t=e.GetEnumerator()},function(){try{return!!t.MoveNext()&&this.Yield(t.Current())}catch(t){return n(t),!1}},function(){r.Dispose(t)})})},Finally:function(n){n=r.CreateLambda(n);var e=this;return new t(function(){var t;return new a(function(){t=e.GetEnumerator()},function(){return!!t.MoveNext()&&this.Yield(t.Current())},function(){try{r.Dispose(t)}finally{n()}})})},Trace:function(t,n){return null==t&&(t="Trace"),n=r.CreateLambda(n),this.Do(function(e){console.log(t,":",n(e))})}};var n={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},e={Boolean:typeof!0,Number:"number",String:"string",Object:typeof{},Undefined:"undefined",Function:"function"},r={CreateLambda:function(t){if(null==t)return n.Identity;if(typeof t==e.String){if(""==t)return n.Identity;if(-1==t.indexOf("=>"))return new Function("$,$$,$$$,$$$$","return "+t);var r=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(r[1],"return "+r[2])}return t},IsIEnumerable:function(t){if(typeof Enumerator!=e.Undefined)try{return new Enumerator(t),!0}catch(t){}return!1},Compare:function(t,n){return t===n?0:t>n?1:-1},Dispose:function(t){null!=t&&t.Dispose()}},i=0,u=1,o=2,a=function(t,n,e){var r=new c,a=i;this.Current=r.Current,this.MoveNext=function(){try{switch(a){case i:a=u,t();case u:return!!n.apply(r)||(this.Dispose(),!1);case o:return!1}}catch(t){throw this.Dispose(),t}},this.Dispose=function(){if(a==u)try{e()}finally{a=o}}},c=function(){var t=null;this.Current=function(){return t},this.Yield=function(n){return t=n,!0}},s=function(t,n,e,i){this.source=t,this.keySelector=r.CreateLambda(n),this.descending=e,this.parent=i};s.prototype=new t,s.prototype.CreateOrderedEnumerable=function(t,n){return new s(this.source,t,n,this)},s.prototype.ThenBy=function(t){return this.CreateOrderedEnumerable(t,!1)},s.prototype.ThenByDescending=function(t){return this.CreateOrderedEnumerable(t,!0)},s.prototype.GetEnumerator=function(){var t,e,r=this,i=0;return new a(function(){t=[],e=[],r.source.ForEach(function(n,r){t.push(n),e.push(r)});var n=f.Create(r,null);n.GenerateKeys(t),e.sort(function(t,e){return n.Compare(t,e)})},function(){return i<e.length&&this.Yield(t[e[i++]])},n.Blank)};var f=function(t,n,e){this.keySelector=t,this.descending=n,this.child=e,this.keys=null};f.Create=function(t,n){var e=new f(t.keySelector,t.descending,n);return null!=t.parent?f.Create(t.parent,e):e},f.prototype.GenerateKeys=function(t){for(var n=t.length,e=this.keySelector,r=new Array(n),i=0;i<n;i++)r[i]=e(t[i]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},f.prototype.Compare=function(t,n){var e=r.Compare(this.keys[t],this.keys[n]);if(0==e){if(null!=this.child)return this.child.Compare(t,n);e=r.Compare(t,n)}return this.descending?-e:e};var l=function(t){this.source=t};l.prototype=new t,l.prototype.Any=function(n){return null==n?this.source.length>0:t.prototype.Any.apply(this,arguments)},l.prototype.Count=function(n){return null==n?this.source.length:t.prototype.Count.apply(this,arguments)},l.prototype.ElementAt=function(n){return 0<=n&&n<this.source.length?this.source[n]:t.prototype.ElementAt.apply(this,arguments)},l.prototype.ElementAtOrDefault=function(t,n){return 0<=t&&t<this.source.length?this.source[t]:n},l.prototype.First=function(n){return null==n&&this.source.length>0?this.source[0]:t.prototype.First.apply(this,arguments)},l.prototype.FirstOrDefault=function(n,e){return null!=e?t.prototype.FirstOrDefault.apply(this,arguments):this.source.length>0?this.source[0]:n},l.prototype.Last=function(n){return null==n&&this.source.length>0?this.source[this.source.length-1]:t.prototype.Last.apply(this,arguments)},l.prototype.LastOrDefault=function(n,e){return null!=e?t.prototype.LastOrDefault.apply(this,arguments):this.source.length>0?this.source[this.source.length-1]:n},l.prototype.Skip=function(e){var r=this.source;return new t(function(){var t;return new a(function(){t=e<0?0:e},function(){return t<r.length&&this.Yield(r[t++])},n.Blank)})},l.prototype.TakeExceptLast=function(t){return null==t&&(t=1),this.Take(this.source.length-t)},l.prototype.TakeFromLast=function(t){return this.Skip(this.source.length-t)},l.prototype.Reverse=function(){var e=this.source;return new t(function(){var t;return new a(function(){t=e.length},function(){return t>0&&this.Yield(e[--t])},n.Blank)})},l.prototype.SequenceEqual=function(n,e){return(!(n instanceof l||n instanceof Array)||null!=e||t.From(n).Count()==this.Count())&&t.prototype.SequenceEqual.apply(this,arguments)},l.prototype.ToString=function(n,e){return null==e&&this.source instanceof Array?(null==n&&(n=""),this.source.join(n)):t.prototype.ToString.apply(this,arguments)},l.prototype.GetEnumerator=function(){var t=this.source,e=0;return new a(n.Blank,function(){return e<t.length&&this.Yield(t[e++])},n.Blank)};var h=function(){var r=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i=function(t){return null===t?"null":void 0===t?"undefined":typeof t.toString===e.Function?t.toString():Object.prototype.toString.call(t)},u=function(t,n){this.Key=t,this.Value=n,this.Prev=null,this.Next=null},o=function(){this.First=null,this.Last=null};o.prototype={AddLast:function(t){null!=this.Last?(this.Last.Next=t,t.Prev=this.Last,this.Last=t):this.First=this.Last=t},Replace:function(t,n){null!=t.Prev?(t.Prev.Next=n,n.Prev=t.Prev):this.First=n,null!=t.Next?(t.Next.Prev=n,n.Next=t.Next):this.Last=n},Remove:function(t){null!=t.Prev?t.Prev.Next=t.Next:this.First=t.Next,null!=t.Next?t.Next.Prev=t.Prev:this.Last=t.Prev}};var c=function(t){this.count=0,this.entryList=new o,this.buckets={},this.compareSelector=null==t?n.Identity:t};return c.prototype={Add:function(t,n){var e=this.compareSelector(t),o=i(e),a=new u(t,n);if(r(this.buckets,o)){for(var c=this.buckets[o],s=0;s<c.length;s++)if(this.compareSelector(c[s].Key)===e)return this.entryList.Replace(c[s],a),void(c[s]=a);c.push(a)}else this.buckets[o]=[a];this.count++,this.entryList.AddLast(a)},Get:function(t){var n=this.compareSelector(t),e=i(n);if(r(this.buckets,e))for(var u=this.buckets[e],o=0;o<u.length;o++){var a=u[o];if(this.compareSelector(a.Key)===n)return a.Value}},Set:function(t,n){var e=this.compareSelector(t),o=i(e);if(r(this.buckets,o))for(var a=this.buckets[o],c=0;c<a.length;c++)if(this.compareSelector(a[c].Key)===e){var s=new u(t,n);return this.entryList.Replace(a[c],s),a[c]=s,!0}return!1},Contains:function(t){var n=this.compareSelector(t),e=i(n);if(!r(this.buckets,e))return!1;for(var u=this.buckets[e],o=0;o<u.length;o++)if(this.compareSelector(u[o].Key)===n)return!0;return!1},Clear:function(){this.count=0,this.buckets={},this.entryList=new o},Remove:function(t){var n=this.compareSelector(t),e=i(n);if(r(this.buckets,e))for(var u=this.buckets[e],o=0;o<u.length;o++)if(this.compareSelector(u[o].Key)===n)return this.entryList.Remove(u[o]),u.splice(o,1),0==u.length&&delete this.buckets[e],void this.count--},Count:function(){return this.count},ToEnumerable:function(){var e=this;return new t(function(){var t;return new a(function(){t=e.entryList.First},function(){if(null!=t){var n={Key:t.Key,Value:t.Value};return t=t.Next,this.Yield(n)}return!1},n.Blank)})}},c}(),v=function(n){this.Count=function(){return n.Count()},this.Get=function(e){return t.From(n.Get(e))},this.Contains=function(t){return n.Contains(t)},this.ToEnumerable=function(){return n.ToEnumerable().Select(function(t){return new p(t.Key,t.Value)})}},p=function(t,n){this.Key=function(){return t},l.call(this,n)};return p.prototype=new l,t}();